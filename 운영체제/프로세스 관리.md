# 프로세스 관리
## 1. 프로세스의 개념
- 프로세스는 수행중인 프로그램을 뜻한다. 

- 프로세스 문맥 : 프로세스가 현재 어떤 상태에서 수행되고 있는지를 정확히 규명하기 위해 필요한 정보
	- 하드웨어 문맥 : 프로그램 카운터 값, 각종 레지스터 값
	- 커널 스택, PCB
## 2. 프로세스의 상태
- 시작 상태 : 프로세스를 위한 자료구조는 생성 되었지만 아직 메모리에 올라가지 않음

- 준비 : CPU만 보유하면 당장 명령을 실행할 수 있지만 CPU를 할당받지 못한 상태
- 실행 : CPU를 보유하고 기계어 명령을 실행하고 있는 상태
- 봉쇄 : 프로세스에게 CPU를 주어도 당장 명령을 실행할 수 없는 상태
## 3. 프로세스 제어 블록(PCB)
- 운영체제가 시스템 내의 프로세스들을 관리하기 위해 프로세스당 유지하는 정보들을 담는 커널 내의 자료구조이다. 
## 4. 문맥 교환
- 하나의 사용자 프로세스로부터 다른 사용자 프로세스로 CPU의 제어권이 이양되는 과정을 뜻한다.

- 타이머 인터럽트, 입출력 시스템 콜 처럼 CPU의 제어권이 다른 프로세스에게 넘어가면 문맥교환이지만 다른 인터럽트나 시스템콜은 커널 내의 명령어를 수행하지만 다시 사용자모드로 돌아와 원래 프로세스의 명령을 수행하기 때문에 문맥교환이 아니다.

## 5. 프로세스를 스케줄링하기 위한 큐
- 작업 큐 :  시스템 내의 모든 프로세스가 작업큐에 속한다. 하지만 작업 큐에 있다고 모두 메모리에 올라가 있는 것은 아니다.

- 준비 큐 : CPU를 할당받기 위해 기다리고 있는 프로세의 집합
- 장치 큐 : 각각의 장치마다 서비스를 기다리며 줄 서 있는 프로세스의 큐를 말한다.
## 6. 스케줄러
- 스케줄러란 어떤 프로세스에게 자원을 할당할지를 결정하는 운영 체제 `커널의 모듈`을 지칭한다.

- 장기 스케줄러 : 어떤 프로세스를 준비큐에 삽입할지를 결정하는 역할을 한다. 요즘에는 프로세스가 생성되자마자 준비큐에 삽입하기 때문에 거의 쓰이지 않는다.
- 중기 스케줄러 : 너무 많은 프로세스에게 메모리를 할당해 시스템의 성능이 저하되는 경우 이를 해결하기 위해 메모리에 적재된 프로세스의 수를 동적으로 조절하기 위해 추가된 스케줄러이다. 중기 스케줄러가 메모리에서 디스크로 스왑 아웃 시켜야 하는 경우 0순위 프로세스는 봉쇄 상태인 프로세스이다. 왜냐하면 당장 CPU를 획득할 가능성이 없어서 메모리를 보유하고 있는 것도 큰 의미가 없기 때문이다. 그래도 메모리가 부족하다면 타이머 인터럽트가 발생해 준비 큐로 이동하는 프로세스이다. 문맥교환이 일어나 봉쇄 상태가 되거나 준비 상태가 된 프로세스들을 스왑 아웃시킨다.
- 단기 스케줄러 : CPU 스케줄러라고도 하며, 준비 상태의 프로세스 중에서 어떤 프로세스에게 CPU를 할당할 것인가를 결정한다.
## 7. 프로세스의 생성
- 시스템이 부팅된 후 최초의 프로세스는 운영체제가 직접 생성하지만 그 다음부터는 이미 존재하는 프로세스가 다른 프로세스를 복제 생성하게 된다.

- 부모 프로세스에서 자식 프로세스 생성
	- fork() 시스템 콜을 하여 커널은 부모 프로세스를 복제해 자식 프로세스를 생성한다. 이때 자식 프로세스는 부모 프로세스와 모든 문맥을 동일하게 가지고 있다.

	- 자신이 복제 되었다는 사실을 모르고 부모와 똑같은 기억을 가지고 있다. 즉 자신이 자식 프로세스를 복제한 줄 알고 있다.
	- 따라서 자식 프로세스에게 부모와는 다른 독자적인 프로그램을 수행시키려면 exec() 시스템 콜을 사용해야 한다. exec() 시스템 콜은 주소 공간을 새로운 프로그램으로 덮어 씌워 새로운 프로그램의 첫 부분부터 실행을 다시 시작하도록 한다.
## 8. 프로세스 간의 협력
- IPC : 하나의 컴퓨터 안에서 실행중인 서로 다른 프로세스 간에 발생하는 통신으로 메시지 전달과, 공유 메모리 방식이 있다.
	-  메시지 전달 : 메일 박스와 직접 프로세스에게 메시지를 전달하는 두 가지 방법이 있다. 두 방법 모두 커널을 통해 메시지를 주고 받게 된다.

	- 공유 메모리 : 프로세스들이 주소 공간의 일부를 공유하게 된다. 실제 구현은 프로세스 A와 B가 주소 공간(가상메모리)을 독자적으로 가지고 있지만 이 주소 공간이 물리적 메모리에 매핑될 때 공유 메모리 주소 영역에 대해서는 동일한 물리적 메모리 주소로 매핑된다.
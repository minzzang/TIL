# 링크 계층
## 1. 링크 계층이 제공하는 서비스
- 프레임화

	- 거의 모든 링크 계층 프로토콜은 네트워크 계층 데이터그램을 링크상으로 전송하기 전에 링크 계층 프레임에 캡슐화한다.
- 링크 접속
	- MAC(medium access control) 프로토콜은 링크상으로 프레임을 전송하는 규칙에 대해 명시한다.
- 신뢰적 전달
	-  링크 계층의 신뢰적 전달 서비스도 확인 응답과 재전송을 통해 가능하다.

	- 광섬유, 동축케이블, 다수의 꼬임쌍선 링크와 같은 낮은 비트 오류율을 가진 링크에서는 불필요한 오버헤드가 될 수 있어 대부분 신뢰적 전달 서비스를 제공하지 않는다.
- 오류 검출과 정정

	- 링크 계층에서의 오류 검출은 하드웨어로 구현된다.

	- 오류 정정은 프레임 안의 오류 검출뿐만 아니라 어느 곳에서 오류가 발생했는지 찾을 수 있다.
	- 오류 검출 방법에는 패리티 비트, 체크섬, 순환 중복검사(CRC)가 있다.

## 2. 다중 접속 링크와 프로토콜
- 채널 분할 프로토콜
	- 시분할 다중화(TDM)

		- 각 시간 프레임을 N개의 시간 슬롯으로 나눠 노드는 전송할 패킷이 있을 때마다 자신에게 할당된 시간 슬롯 동안 패킷 비트들을 전송한다.

		- 전송할 패킷이 있는 노드가 단 하나인 경우에도 채널 전송률이 R bps라고 할 때 노드의 전송률이 R/N이다. 
		- 노드가 전송 순서상 자신의 차례를 항상 기다려야 해서 비효율적이다.
	- 주파수 분할 다중화(FDM)
		- FDM은 R bps의 채널을 다른 주파수로 나눠서 N개 노드 중 하나에게 할당한다.

		- FDM은 TDM과 같은 장단점이 있다. 전송할 패킷을 가진 노드가 단 하나여도 노드는 R/N의 대역폭으로 한정된다.

- 랜덤 접속 프로토콜
	- 랜덤 접속 프로토콜에서 전송 노드는 항상 채널의 최대 전송률인 R bps로 전송한다.

	- 충돌이 생기면 충돌과 관련된 각 노드는 랜덤 지연 시간동안 기다린 후 재전송한다.
	- 슬롯 알로하 
		- 시간을 노드가 하나의 프레임을 보낼 수 있는 시간 단위로 나눈다.
		- 슬롯의 시작점에서만 프레임을 보낼 수 있는데 동시에 여러 노드가 프레임을 보낸다면 슬롯이 끝나기전에 노드들은 충돌을 알게된다.

		- 충돌이 발생한 노드들은 각자 확률p로 프레임을 재전송한다.
		- 확률p는 1이면 재전송 0이면 한 슬롯 쉬고 다음 슬롯에서 전송할 수 있다.
		- 활성노드가 많으면 일부 슬롯이 낭비되는 문제점이 있다.
	- 알로하
		- 알로하는 슬롯이 없고 프레임이 도착하면 즉시 브로드캐스트 채널로 전송한다.

		- 충돌이 발생하면 노드는 확률 p로 재전송하고 1-p확률로 기다린다.
	- CSMA (Carrier Sense Multiple Access)
		-  CSMA는 노드가 프레임을 전송하기 전에 채널에 전송되는 프레임이 있는지 확인 후 전송한다.

		- 노드가 프레임을 전송하면서 동시에 채널을 듣고 방해 프레임을 전송하고 있음을 검출하면, 전송을 중단하고 랜덤 시간 동안 기다린 후 다시 전송한다.

## 3. 스위치 근거리 네트워크
- MAC 주소
	-  링크 계층 주소로 사용되며, 랜 주소, 물리 주소로 불리기도 한다.
	- 6바이트의 주소 길이를 가지며 16진수로 표기된다.
- ARP (Address Resolution Protocol)
	- IP주소를 MAC주소로 변환해준다.
	- 동일한 서브넷상에 있는 호스트나 라우터의 IP주소만 변환할 수 있다.
 

- 이더넷 프레임 구조
	- 데이터 필드 

		- IP 데이터 그램을 운반한다.

		- MTU는 1500바이트이다.
		- 최소 크기는 46바이트로 46바이트 보다 작으면 데이터 필드를 채워서 46바이트로 만들어야 한다.
	- 타입 필드
		- 이더넷이 네트워크 계층 프로토콜을 다중화하도록 허용한다.

		- 타입 필드는 네트워크 계층의 프로토콜 필드와 트랜스포트 계층의 포트 번호와 비슷하다.
	- 순환 중복 검사
		- 프레임에 오류가 있는지 검출하는 필드
	- 프리앰블
		- 8바이트 필드로 첫 7바이트는 수신자의 클록을 송신자의 클록에 동기화시키는 역할을 한다.
- 링크 계층 스위치
	- 여과
		- 프레임을 인터페이스로 전달할지 또는 폐기할지 결정하는 스위치의 기능
	- 전달
		- 프레임이 전송될 인터페이스를 결정하고 프레임을 해당 인터페이스로 내보내는 기능이다.

		- 스위치의 여과와 전달은 `스위치 테이블`을 이용한다.

	-	자가학습
		-	스위치 테이블은 초기에 비어 있다.

		-	인터페이스로 수신한 각 프레임에 대해 스위치는 `1.프레임의 출발지 주소 필드에 있는 MAC주소`, `2.프레임이 도착한 인터페이스`, `3.현재 시간`을 테이블에 저장한다.
		-	일정 시간이 지난 후에도 스위치가 해당 주소를 출발지 주소로 하는 프레임을 수신하지 못하면 테이블에서 이 주소를 삭제한다.
